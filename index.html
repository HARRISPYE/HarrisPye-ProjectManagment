<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harris Pye - Project Manager</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* App Container */
        .app-container {
            display: flex;
            min-height: 100vh;
            background: #f8fafc;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            display: flex;
            flex-direction: column;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .logo i {
            font-size: 2rem;
            color: #fbbf24;
        }

        /* Navigation */
        .sidebar-nav {
            flex: 1;
            padding: 1.5rem 0;
        }

        .sidebar-nav ul {
            list-style: none;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: #fbbf24;
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            border-left-color: #fbbf24;
        }

        .nav-item i {
            font-size: 1.25rem;
            width: 20px;
        }

        /* Sidebar Footer */
        .sidebar-footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .save-btn {
            width: 100%;
            background: #10b981;
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .save-btn:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: white;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .page-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .page-subtitle {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .auto-save-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #e5e7eb;
        }

        /* Page Content */
        .page-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: #f9fafb;
        }

        .page {
            display: block;
        }

        .page.hidden {
            display: none;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }

        /* Overview Cards */
        .overview-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .overview-card {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 0.75rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .card-content h3 {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .card-label {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .chart-card {
            padding: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }

        .chart-controls {
            display: flex;
            gap: 0.5rem;
        }

        .chart-container {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f9fafb;
            border-radius: 0.5rem;
            color: #6b7280;
        }

        /* Recent Tasks */
        .recent-tasks-card {
            padding: 1.5rem;
        }

        .view-all {
            color: #4f46e5;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .recent-tasks {
            max-height: 300px;
            overflow-y: auto;
        }

        .task-item {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: #f9fafb;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .task-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .task-description {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }

        .task-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            font-size: 0.75rem;
        }

        .task-status, .task-priority {
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .task-status.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .task-status.in-progress {
            background: #dbeafe;
            color: #1e40af;
        }

        .task-status.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .task-status.overdue {
            background: #fee2e2;
            color: #991b1b;
        }

        .task-priority.high {
            background: #fee2e2;
            color: #991b1b;
        }

        .task-priority.medium {
            background: #fef3c7;
            color: #92400e;
        }

        .task-priority.low {
            background: #d1fae5;
            color: #065f46;
        }

        .task-dates, .task-assignee {
            color: #6b7280;
        }

        /* Page Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .page-header h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #1f2937;
        }

        /* Buttons */
        .btn-primary, .btn-secondary {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #4f46e5;
            color: white;
        }

        .btn-primary:hover {
            background: #4338ca;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        /* Tasks Container */
        .tasks-container {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .tasks-filters {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-group label {
            font-weight: 500;
            color: #374151;
        }

        .filter-group select {
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background: white;
        }

        .search-group {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .search-group input {
            width: 100%;
            padding: 0.5rem 2.5rem 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
        }

        .search-group i {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .tasks-list {
            min-height: 400px;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        .edit-btn, .delete-btn {
            padding: 0.375rem 0.75rem;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn {
            background: #dbeafe;
            color: #1e40af;
        }

        .edit-btn:hover {
            background: #bfdbfe;
        }

        .delete-btn {
            background: #fee2e2;
            color: #991b1b;
        }

        .delete-btn:hover {
            background: #fecaca;
        }

        /* Team Grid */
        .team-container {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .team-member {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .team-member:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .member-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 auto 1rem;
        }

        .member-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .member-role {
            color: #4f46e5;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .member-department {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .member-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        /* Timeline */
        .timeline-container {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            min-height: 500px;
        }

        .timeline-controls {
            display: flex;
            gap: 0.5rem;
        }

        /* Reports */
        .reports-container {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            min-height: 500px;
        }

        .report-controls {
            display: flex;
            gap: 0.5rem;
        }

        /* Settings */
        .settings-container {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }

        .settings-form {
            max-width: 600px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* Export/Import Controls */
        .export-import-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            padding: 1.5rem;
            background: #f9fafb;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
        }

        .export-btn, .import-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .export-btn {
            background: #10b981;
            color: white;
        }

        .export-btn:hover {
            background: #059669;
        }

        .import-btn {
            background: #3b82f6;
            color: white;
        }

        .import-btn:hover {
            background: #2563eb;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #9ca3af;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #9ca3af;
        }

        .modal-close:hover {
            color: #374151;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Timeline Styles */
        .timeline-item {
            display: flex;
            margin-bottom: 2rem;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 40px;
            bottom: -20px;
            width: 2px;
            background: #e5e7eb;
        }

        .timeline-item:last-child::before {
            display: none;
        }

        .timeline-marker {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #4f46e5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-right: 1rem;
            flex-shrink: 0;
            z-index: 1;
            position: relative;
        }

        .timeline-content {
            flex: 1;
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            border: 1px solid #e5e7eb;
        }

        .timeline-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .timeline-description {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .timeline-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: fixed;
                top: 0;
                left: -100%;
                z-index: 1000;
                transition: left 0.3s ease;
            }

            .sidebar.open {
                left: 0;
            }

            .main-content {
                width: 100%;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .overview-cards {
                grid-template-columns: 1fr;
            }

            .tasks-filters {
                flex-direction: column;
                align-items: stretch;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .export-import-controls {
                flex-direction: column;
                align-items: stretch;
            }
        }

        /* Message Styles */
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 500;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .message.show {
            transform: translateX(0);
        }

        .message.success {
            background: #10b981;
        }

        .message.error {
            background: #ef4444;
        }

        .message.info {
            background: #3b82f6;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCzKHqeHioi3MnaP8Z-UU3v65sMafoAqRc",
            authDomain: "harrispye-9d533.firebaseapp.com",
            projectId: "harrispye-9d533",
            storageBucket: "harrispye-9d533.firebasestorage.app",
            messagingSenderId: "448917645374",
            appId: "1:448917645374:web:1aff0e8d0112f93ebe896f",
            measurementId: "G-CJZ910NNHZ"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-industry"></i>
                    <span>Harris Pye PM</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item active" data-page="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </li>
                    <li class="nav-item" data-page="tasks">
                        <i class="fas fa-tasks"></i>
                        <span>Tasks</span>
                    </li>
                    <li class="nav-item" data-page="timeline">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Timeline</span>
                    </li>
                    <li class="nav-item" data-page="team">
                        <i class="fas fa-users"></i>
                        <span>Team</span>
                    </li>
                    <li class="nav-item" data-page="reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reports</span>
                    </li>
                    <li class="nav-item" data-page="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button class="save-btn" id="saveData">
                    <i class="fas fa-save"></i>
                    <span>Save Data</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1 class="page-title">Project Dashboard</h1>
                    <p class="page-subtitle">Aramco Sadqam - Boilers Replacement Project</p>
                </div>
                <div class="header-right">
                    <div class="auto-save-indicator">
                        <i class="fas fa-circle" id="saveIndicator"></i>
                        <span id="saveStatus">Auto-saved</span>
                    </div>
                    <div class="user-profile">
                        <img src="https://via.placeholder.com/40x40/4F46E5/FFFFFF?text=PM" alt="Profile" class="profile-img">
                        <span class="user-name">Project Manager</span>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="page-content">
                <!-- Dashboard Page -->
                <div class="page" id="dashboard-page">
                    <!-- Project Overview Cards -->
                    <div class="overview-cards">
                        <div class="card overview-card">
                            <div class="card-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="card-content">
                                <h3>Project Duration</h3>
                                <p class="card-value" id="projectDuration">5 Months</p>
                                <span class="card-label">Total Timeline</span>
                            </div>
                        </div>
                        
                        <div class="card overview-card">
                            <div class="card-icon">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div class="card-content">
                                <h3>Total Tasks</h3>
                                <p class="card-value" id="totalTasks">0</p>
                                <span class="card-label">Active Tasks</span>
                            </div>
                        </div>
                        
                        <div class="card overview-card">
                            <div class="card-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="card-content">
                                <h3>Progress</h3>
                                <p class="card-value" id="overallProgress">0%</p>
                                <span class="card-label">Completed</span>
                            </div>
                        </div>
                        
                        <div class="card overview-card">
                            <div class="card-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="card-content">
                                <h3>Team Members</h3>
                                <p class="card-value" id="teamCount">0</p>
                                <span class="card-label">Active Members</span>
                            </div>
                        </div>
                    </div>

                    <!-- Progress Chart -->
                    <div class="dashboard-grid">
                        <div class="card chart-card">
                            <div class="card-header">
                                <h3>Project Progress</h3>
                                <div class="chart-controls">
                                    <button class="btn-secondary">Week</button>
                                    <button class="btn-primary">Month</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="progressChart"></canvas>
                            </div>
                        </div>

                        <!-- Recent Tasks -->
                        <div class="card recent-tasks-card">
                            <div class="card-header">
                                <h3>Recent Tasks</h3>
                                <a href="#" class="view-all">View All</a>
                            </div>
                            <div class="recent-tasks" id="recentTasks">
                                <div class="empty-state">
                                    <i class="fas fa-clipboard-list"></i>
                                    <p>No tasks yet. Create your first task!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tasks Page -->
                <div class="page hidden" id="tasks-page">
                    <div class="page-header">
                        <h2>Task Management</h2>
                        <button class="btn-primary" id="addTaskBtn">
                            <i class="fas fa-plus"></i>
                            Add New Task
                        </button>
                    </div>
                    
                    <div class="tasks-container">
                        <div class="tasks-filters">
                            <div class="filter-group">
                                <label>Status:</label>
                                <select id="statusFilter">
                                    <option value="all">All Tasks</option>
                                    <option value="pending">Pending</option>
                                    <option value="in-progress">In Progress</option>
                                    <option value="completed">Completed</option>
                                    <option value="overdue">Overdue</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Priority:</label>
                                <select id="priorityFilter">
                                    <option value="all">All Priorities</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                            <div class="search-group">
                                <input type="text" id="taskSearch" placeholder="Search tasks...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <div class="tasks-list" id="tasksList">
                            <div class="empty-state">
                                <i class="fas fa-clipboard-list"></i>
                                <p>No tasks found. Create your first task to get started!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timeline Page -->
                <div class="page hidden" id="timeline-page">
                    <div class="page-header">
                        <h2>Project Timeline</h2>
                        <div class="timeline-controls">
                            <button class="btn-secondary">Month View</button>
                            <button class="btn-primary">Gantt View</button>
                        </div>
                    </div>
                    
                    <div class="timeline-container">
                        <div class="timeline-content" id="timelineContent">
                            <div class="empty-state">
                                <i class="fas fa-calendar-alt"></i>
                                <p>Timeline will appear here once tasks are created</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Team Page -->
                <div class="page hidden" id="team-page">
                    <div class="page-header">
                        <h2>Team Management</h2>
                        <button class="btn-primary" id="addTeamMemberBtn">
                            <i class="fas fa-user-plus"></i>
                            Add Team Member
                        </button>
                    </div>
                    
                    <div class="team-container">
                        <div class="team-grid" id="teamGrid">
                            <div class="empty-state">
                                <i class="fas fa-users"></i>
                                <p>No team members added yet. Add your first team member!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reports Page -->
                <div class="page hidden" id="reports-page">
                    <div class="page-header">
                        <h2>Project Reports</h2>
                        <div class="report-controls">
                            <button class="btn-secondary">Export PDF</button>
                            <button class="btn-primary">Generate Report</button>
                        </div>
                    </div>
                    
                    <div class="reports-container">
                        <div class="reports-content" id="reportsContent">
                            <div class="empty-state">
                                <i class="fas fa-chart-bar"></i>
                                <p>Reports will be generated based on project data</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Page -->
                <div class="page hidden" id="settings-page">
                    <div class="page-header">
                        <h2>Project Settings</h2>
                    </div>
                    
                    <div class="settings-container">
                        <div class="settings-form">
                            <div class="form-group">
                                <label for="projectName">Project Name</label>
                                <input type="text" id="projectName" value="Aramco Sadqam - Boilers Replacement">
                            </div>
                            
                            <div class="form-group">
                                <label for="projectCompany">Company</label>
                                <input type="text" id="projectCompany" value="Harris Pye">
                            </div>
                            
                            <div class="form-group">
                                <label for="projectClient">Client</label>
                                <input type="text" id="projectClient" value="Aramco Sadqam">
                            </div>
                            
                            <div class="form-group">
                                <label for="projectDurationSetting">Project Duration (Months)</label>
                                <input type="number" id="projectDurationSetting" value="5" min="1" max="24">
                            </div>
                            
                            <div class="form-group">
                                <label for="projectStartDate">Start Date</label>
                                <input type="date" id="projectStartDate">
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn-primary" id="saveSettings">Save Settings</button>
                                <button class="btn-secondary" id="resetSettings">Reset to Default</button>
                            </div>
                            
                            <div class="export-import-controls">
                                <button class="export-btn" id="exportDataBtn">
                                    <i class="fas fa-download"></i>
                                    Export Data
                                </button>
                                <div class="file-input-wrapper">
                                    <button class="import-btn" id="triggerImport">
                                        <i class="fas fa-upload"></i>
                                        Import Data
                                    </button>
                                    <input type="file" id="importFileInput" accept=".json" style="display: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add Task Modal -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Task</h3>
                <button class="modal-close" data-modal="addTaskModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addTaskForm">
                    <div class="form-group">
                        <label for="taskTitle">Task Title</label>
                        <input type="text" id="taskTitle" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDescription">Description</label>
                        <textarea id="taskDescription" rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPriority">Priority</label>
                            <select id="taskPriority">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="taskStatus">Status</label>
                            <select id="taskStatus">
                                <option value="pending" selected>Pending</option>
                                <option value="in-progress">In Progress</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskStartDate">Start Date</label>
                            <input type="date" id="taskStartDate">
                        </div>
                        
                        <div class="form-group">
                            <label for="taskEndDate">End Date</label>
                            <input type="date" id="taskEndDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskAssignee">Assignee</label>
                        <select id="taskAssignee">
                            <option value="">Select team member</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" data-modal="addTaskModal">Cancel</button>
                <button class="btn-primary" id="submitTask">Add Task</button>
            </div>
        </div>
    </div>

    <!-- Add Team Member Modal -->
    <div class="modal" id="addTeamMemberModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Team Member</h3>
                <button class="modal-close" data-modal="addTeamMemberModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addTeamMemberForm">
                    <div class="form-group">
                        <label for="memberName">Full Name</label>
                        <input type="text" id="memberName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="memberRole">Role</label>
                        <input type="text" id="memberRole" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="memberEmail">Email</label>
                        <input type="email" id="memberEmail">
                    </div>
                    
                    <div class="form-group">
                        <label for="memberDepartment">Department</label>
                        <select id="memberDepartment">
                            <option value="project-management">Project Management</option>
                            <option value="engineering">Engineering</option>
                            <option value="construction">Construction</option>
                            <option value="safety">Safety</option>
                            <option value="quality">Quality</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" data-modal="addTeamMemberModal">Cancel</button>
                <button class="btn-primary" id="submitTeamMember">Add Member</button>
            </div>
        </div>
    </div>

    <script>
        // Project Management Application
        class ProjectManager {
            constructor() {
                this.data = {
                    project: {
                        name: "Aramco Sadqam - Boilers Replacement",
                        company: "Harris Pye",
                        client: "Aramco Sadqam",
                        duration: 5,
                        startDate: new Date().toISOString().split('T')[0],
                        endDate: this.calculateEndDate(5)
                    },
                    tasks: [],
                    teamMembers: [],
                    settings: {
                        autoSave: true,
                        theme: 'light'
                    }
                };
                
                this.currentPage = 'dashboard';
                this.init();
            }

            init() {
                this.loadData();
                this.setupEventListeners();
                this.updateUI();
                this.startAutoSave();
                this.showPage('dashboard');
                this.setupExportImport();
                
                // Add some sample data for demonstration
                if (this.data.tasks.length === 0) {
                    this.addSampleData();
                }
            }

            // Data Management
            loadData() {
                const savedData = localStorage.getItem('harris-pye-project-data');
                if (savedData) {
                    try {
                        const parsed = JSON.parse(savedData);
                        this.data = { ...this.data, ...parsed };
                        this.showMessage('Data loaded successfully', 'success');
                    } catch (error) {
                        console.error('Error loading data:', error);
                        this.showMessage('Error loading saved data', 'error');
                    }
                }
            }

            saveData() {
                try {
                    localStorage.setItem('harris-pye-project-data', JSON.stringify(this.data));
                    this.updateSaveIndicator('saved');
                    return true;
                } catch (error) {
                    console.error('Error saving data:', error);
                    this.showMessage('Error saving data', 'error');
                    return false;
                }
            }

            startAutoSave() {
                if (this.data.settings.autoSave) {
                    setInterval(() => {
                        this.saveData();
                    }, 30000); // Auto-save every 30 seconds
                }
            }

            updateSaveIndicator(status) {
                const indicator = document.getElementById('saveIndicator');
                const statusText = document.getElementById('saveStatus');
                
                if (status === 'saved') {
                    indicator.style.color = '#10b981';
                    statusText.textContent = 'Auto-saved';
                } else if (status === 'saving') {
                    indicator.style.color = '#f59e0b';
                    statusText.textContent = 'Saving...';
                } else if (status === 'error') {
                    indicator.style.color = '#ef4444';
                    statusText.textContent = 'Save error';
                }
            }

            // Navigation
            setupEventListeners() {
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const page = item.dataset.page;
                        this.showPage(page);
                    });
                });

                // Save button
                document.getElementById('saveData').addEventListener('click', () => {
                    this.updateSaveIndicator('saving');
                    if (this.saveData()) {
                        this.showMessage('Data saved successfully!', 'success');
                    }
                });

                // Modal controls
                this.setupModalControls();
                
                // Form submissions
                this.setupFormHandlers();
                
                // Filters and search
                this.setupFilters();
            }

            showPage(pageId) {
                // Update navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-page="${pageId}"]`).classList.add('active');

                // Update page title
                const titles = {
                    dashboard: 'Project Dashboard',
                    tasks: 'Task Management',
                    timeline: 'Project Timeline',
                    team: 'Team Management',
                    reports: 'Project Reports',
                    settings: 'Project Settings'
                };
                document.querySelector('.page-title').textContent = titles[pageId];

                // Show/hide pages
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.add('hidden');
                });
                document.getElementById(`${pageId}-page`).classList.remove('hidden');

                this.currentPage = pageId;
                this.updatePageContent(pageId);
            }

            updatePageContent(pageId) {
                switch (pageId) {
                    case 'dashboard':
                        this.updateDashboard();
                        break;
                    case 'tasks':
                        this.updateTasksList();
                        break;
                    case 'team':
                        this.updateTeamGrid();
                        break;
                    case 'timeline':
                        this.updateTimeline();
                        break;
                    case 'reports':
                        this.updateReports();
                        break;
                    case 'settings':
                        this.updateSettings();
                        break;
                }
            }

            // Dashboard
            updateDashboard() {
                // Update overview cards
                document.getElementById('projectDuration').textContent = `${this.data.project.duration} Months`;
                document.getElementById('totalTasks').textContent = this.data.tasks.length;
                document.getElementById('teamCount').textContent = this.data.teamMembers.length;
                
                // Calculate progress
                const completedTasks = this.data.tasks.filter(task => task.status === 'completed').length;
                const progress = this.data.tasks.length > 0 ? Math.round((completedTasks / this.data.tasks.length) * 100) : 0;
                document.getElementById('overallProgress').textContent = `${progress}%`;

                // Update recent tasks
                this.updateRecentTasks();
            }

            updateRecentTasks() {
                const container = document.getElementById('recentTasks');
                const recentTasks = this.data.tasks.slice(-5).reverse();

                if (recentTasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-clipboard-list"></i>
                            <p>No tasks yet. Create your first task!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = recentTasks.map(task => `
                    <div class="task-item">
                        <div class="task-header">
                            <div class="task-title">${task.title}</div>
                            <span class="task-status ${task.status}">${this.formatStatus(task.status)}</span>
                        </div>
                        <div class="task-meta">
                            <span class="task-priority ${task.priority}">${task.priority.toUpperCase()}</span>
                            ${task.endDate ? `<span class="task-dates">Due: ${this.formatDate(task.endDate)}</span>` : ''}
                        </div>
                    </div>
                `).join('');
            }

            // Tasks Management
            updateTasksList() {
                const container = document.getElementById('tasksList');
                let filteredTasks = [...this.data.tasks];

                // Apply filters
                const statusFilter = document.getElementById('statusFilter')?.value;
                const priorityFilter = document.getElementById('priorityFilter')?.value;
                const searchTerm = document.getElementById('taskSearch')?.value?.toLowerCase();

                if (statusFilter && statusFilter !== 'all') {
                    filteredTasks = filteredTasks.filter(task => task.status === statusFilter);
                }

                if (priorityFilter && priorityFilter !== 'all') {
                    filteredTasks = filteredTasks.filter(task => task.priority === priorityFilter);
                }

                if (searchTerm) {
                    filteredTasks = filteredTasks.filter(task => 
                        task.title.toLowerCase().includes(searchTerm) ||
                        task.description.toLowerCase().includes(searchTerm)
                    );
                }

                if (filteredTasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-clipboard-list"></i>
                            <p>No tasks found. Create your first task to get started!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = filteredTasks.map(task => this.createTaskHTML(task)).join('');
                this.setupTaskActions();
            }

            createTaskHTML(task) {
                const assignee = this.data.teamMembers.find(member => member.id === task.assigneeId);
                const isOverdue = task.endDate && new Date(task.endDate) < new Date() && task.status !== 'completed';
                
                return `
                    <div class="task-item" data-task-id="${task.id}">
                        <div class="task-header">
                            <div>
                                <div class="task-title">${task.title}</div>
                                <div class="task-description">${task.description || ''}</div>
                            </div>
                            <div class="task-actions">
                                <button class="edit-btn" onclick="projectManager.editTask('${task.id}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="delete-btn" onclick="projectManager.deleteTask('${task.id}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="task-meta">
                            <span class="task-status ${task.status} ${isOverdue ? 'overdue' : ''}">${this.formatStatus(task.status)}</span>
                            <span class="task-priority ${task.priority}">${task.priority.toUpperCase()}</span>
                            ${task.startDate ? `<span class="task-dates">Start: ${this.formatDate(task.startDate)}</span>` : ''}
                            ${task.endDate ? `<span class="task-dates">End: ${this.formatDate(task.endDate)}</span>` : ''}
                            ${assignee ? `<span class="task-assignee">Assigned to: ${assignee.name}</span>` : ''}
                        </div>
                    </div>
                `;
            }

            setupTaskActions() {
                // Task actions are handled by onclick attributes in the HTML
            }

            addTask(taskData) {
                const task = {
                    id: this.generateId(),
                    title: taskData.title,
                    description: taskData.description,
                    priority: taskData.priority,
                    status: taskData.status,
                    startDate: taskData.startDate,
                    endDate: taskData.endDate,
                    assigneeId: taskData.assigneeId,
                    createdAt: new Date().toISOString()
                };

                this.data.tasks.push(task);
                this.saveData();
                this.updateUI();
                this.showMessage('Task added successfully!', 'success');
            }

            editTask(taskId) {
                const task = this.data.tasks.find(t => t.id === taskId);
                if (!task) return;

                // Populate form with task data
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description || '';
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskStatus').value = task.status;
                document.getElementById('taskStartDate').value = task.startDate || '';
                document.getElementById('taskEndDate').value = task.endDate || '';
                document.getElementById('taskAssignee').value = task.assigneeId || '';

                // Change form to edit mode
                const form = document.getElementById('addTaskForm');
                form.dataset.editId = taskId;
                document.querySelector('#addTaskModal .modal-header h3').textContent = 'Edit Task';
                document.querySelector('#addTaskModal .btn-primary').textContent = 'Update Task';

                this.showModal('addTaskModal');
            }

            deleteTask(taskId) {
                if (confirm('Are you sure you want to delete this task?')) {
                    this.data.tasks = this.data.tasks.filter(t => t.id !== taskId);
                    this.saveData();
                    this.updateUI();
                    this.showMessage('Task deleted successfully!', 'success');
                }
            }

            // Team Management
            updateTeamGrid() {
                const container = document.getElementById('teamGrid');
                
                if (this.data.teamMembers.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <p>No team members added yet. Add your first team member!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.data.teamMembers.map(member => `
                    <div class="team-member" data-member-id="${member.id}">
                        <div class="member-avatar">
                            ${member.name.split(' ').map(n => n[0]).join('').toUpperCase()}
                        </div>
                        <div class="member-name">${member.name}</div>
                        <div class="member-role">${member.role}</div>
                        <div class="member-department">${member.department}</div>
                        <div class="member-actions" style="margin-top: 1rem;">
                            <button class="edit-btn" onclick="projectManager.editTeamMember('${member.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="delete-btn" onclick="projectManager.deleteTeamMember('${member.id}')">
                                <i class="fas fa-trash"></i> Remove
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            addTeamMember(memberData) {
                const member = {
                    id: this.generateId(),
                    name: memberData.name,
                    role: memberData.role,
                    email: memberData.email,
                    department: memberData.department,
                    createdAt: new Date().toISOString()
                };

                this.data.teamMembers.push(member);
                this.updateTaskAssigneeOptions();
                this.saveData();
                this.updateUI();
                this.showMessage('Team member added successfully!', 'success');
            }

            editTeamMember(memberId) {
                const member = this.data.teamMembers.find(m => m.id === memberId);
                if (!member) return;

                // Populate form with member data
                document.getElementById('memberName').value = member.name;
                document.getElementById('memberRole').value = member.role;
                document.getElementById('memberEmail').value = member.email || '';
                document.getElementById('memberDepartment').value = member.department;

                // Change form to edit mode
                const form = document.getElementById('addTeamMemberForm');
                form.dataset.editId = memberId;
                document.querySelector('#addTeamMemberModal .modal-header h3').textContent = 'Edit Team Member';
                document.querySelector('#addTeamMemberModal .btn-primary').textContent = 'Update Member';

                this.showModal('addTeamMemberModal');
            }

            deleteTeamMember(memberId) {
                if (confirm('Are you sure you want to remove this team member?')) {
                    this.data.teamMembers = this.data.teamMembers.filter(m => m.id !== memberId);
                    this.updateTaskAssigneeOptions();
                    this.saveData();
                    this.updateUI();
                    this.showMessage('Team member removed successfully!', 'success');
                }
            }

            updateTaskAssigneeOptions() {
                const select = document.getElementById('taskAssignee');
                if (!select) return;

                select.innerHTML = '<option value="">Select team member</option>' +
                    this.data.teamMembers.map(member => 
                        `<option value="${member.id}">${member.name} - ${member.role}</option>`
                    ).join('');
            }

            // Timeline
            updateTimeline() {
                const container = document.getElementById('timelineContent');
                
                if (this.data.tasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-alt"></i>
                            <p>Timeline will appear here once tasks are created</p>
                        </div>
                    `;
                    return;
                }

                // Sort tasks by start date
                const sortedTasks = [...this.data.tasks].sort((a, b) => {
                    const dateA = new Date(a.startDate || a.createdAt);
                    const dateB = new Date(b.startDate || b.createdAt);
                    return dateA - dateB;
                });

                container.innerHTML = sortedTasks.map((task, index) => {
                    const assignee = this.data.teamMembers.find(member => member.id === task.assigneeId);
                    return `
                        <div class="timeline-item">
                            <div class="timeline-marker">${index + 1}</div>
                            <div class="timeline-content">
                                <div class="timeline-title">${task.title}</div>
                                <div class="timeline-description">${task.description || 'No description provided'}</div>
                                <div class="timeline-meta">
                                    <span class="task-status ${task.status}">${this.formatStatus(task.status)}</span>
                                    <span class="task-priority ${task.priority}">${task.priority.toUpperCase()}</span>
                                    ${task.startDate ? `<span>Start: ${this.formatDate(task.startDate)}</span>` : ''}
                                    ${task.endDate ? `<span>End: ${this.formatDate(task.endDate)}</span>` : ''}
                                    ${assignee ? `<span>Assigned to: ${assignee.name}</span>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Reports
            updateReports() {
                const container = document.getElementById('reportsContent');
                
                if (this.data.tasks.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-chart-bar"></i>
                            <p>Reports will be generated based on project data</p>
                        </div>
                    `;
                    return;
                }

                // Generate basic statistics
                const totalTasks = this.data.tasks.length;
                const completedTasks = this.data.tasks.filter(task => task.status === 'completed').length;
                const inProgressTasks = this.data.tasks.filter(task => task.status === 'in-progress').length;
                const pendingTasks = this.data.tasks.filter(task => task.status === 'pending').length;
                const overdueTasks = this.data.tasks.filter(task => {
                    return task.endDate && new Date(task.endDate) < new Date() && task.status !== 'completed';
                }).length;

                const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

                container.innerHTML = `
                    <div class="reports-stats">
                        <h3>Project Statistics</h3>
                        <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #1f2937;">${totalTasks}</div>
                                <div style="color: #6b7280;">Total Tasks</div>
                            </div>
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #10b981;">${completedTasks}</div>
                                <div style="color: #6b7280;">Completed</div>
                            </div>
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #3b82f6;">${inProgressTasks}</div>
                                <div style="color: #6b7280;">In Progress</div>
                            </div>
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;">${pendingTasks}</div>
                                <div style="color: #6b7280;">Pending</div>
                            </div>
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #ef4444;">${overdueTasks}</div>
                                <div style="color: #6b7280;">Overdue</div>
                            </div>
                            <div class="stat-card" style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                                <div style="font-size: 2rem; font-weight: 700; color: #8b5cf6;">${progress}%</div>
                                <div style="color: #6b7280;">Progress</div>
                            </div>
                        </div>
                        
                        <h4 style="margin-top: 2rem; margin-bottom: 1rem;">Team Performance</h4>
                        <div class="team-performance">
                            ${this.data.teamMembers.map(member => {
                                const memberTasks = this.data.tasks.filter(task => task.assigneeId === member.id);
                                const memberCompleted = memberTasks.filter(task => task.status === 'completed').length;
                                const memberProgress = memberTasks.length > 0 ? Math.round((memberCompleted / memberTasks.length) * 100) : 0;
                                
                                return `
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: #f9fafb; border-radius: 0.5rem; margin-bottom: 0.5rem;">
                                        <div>
                                            <div style="font-weight: 600;">${member.name}</div>
                                            <div style="font-size: 0.875rem; color: #6b7280;">${member.role}</div>
                                        </div>
                                        <div style="text-align: right;">
                                            <div style="font-weight: 600;">${memberCompleted}/${memberTasks.length} tasks</div>
                                            <div style="font-size: 0.875rem; color: #6b7280;">${memberProgress}% complete</div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }

            // Settings
            updateSettings() {
                // Populate settings form with current data
                document.getElementById('projectName').value = this.data.project.name;
                document.getElementById('projectCompany').value = this.data.project.company;
                document.getElementById('projectClient').value = this.data.project.client;
                document.getElementById('projectDurationSetting').value = this.data.project.duration;
                document.getElementById('projectStartDate').value = this.data.project.startDate;
            }

            // Modal Management
            setupModalControls() {
                // Modal close buttons
                document.querySelectorAll('.modal-close, [data-modal]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const modalId = btn.dataset.modal || btn.closest('.modal').id;
                        this.hideModal(modalId);
                    });
                });

                // Add task button
                document.getElementById('addTaskBtn')?.addEventListener('click', () => {
                    this.resetTaskForm();
                    this.showModal('addTaskModal');
                });

                // Add team member button
                document.getElementById('addTeamMemberBtn')?.addEventListener('click', () => {
                    this.resetTeamMemberForm();
                    this.showModal('addTeamMemberModal');
                });

                // Close modal when clicking outside
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.hideModal(modal.id);
                        }
                    });
                });
            }

            showModal(modalId) {
                document.getElementById(modalId).classList.add('show');
            }

            hideModal(modalId) {
                document.getElementById(modalId).classList.remove('show');
            }

            resetTaskForm() {
                const form = document.getElementById('addTaskForm');
                form.reset();
                delete form.dataset.editId;
                document.querySelector('#addTaskModal .modal-header h3').textContent = 'Add New Task';
                document.querySelector('#addTaskModal .btn-primary').textContent = 'Add Task';
                this.updateTaskAssigneeOptions();
            }

            resetTeamMemberForm() {
                const form = document.getElementById('addTeamMemberForm');
                form.reset();
                delete form.dataset.editId;
                document.querySelector('#addTeamMemberModal .modal-header h3').textContent = 'Add Team Member';
                document.querySelector('#addTeamMemberModal .btn-primary').textContent = 'Add Member';
            }

            // Form Handlers
            setupFormHandlers() {
                // Task form submission
                document.getElementById('submitTask')?.addEventListener('click', () => {
                    const form = document.getElementById('addTaskForm');
                    const formData = new FormData(form);
                    
                    const taskData = {
                        title: document.getElementById('taskTitle').value,
                        description: document.getElementById('taskDescription').value,
                        priority: document.getElementById('taskPriority').value,
                        status: document.getElementById('taskStatus').value,
                        startDate: document.getElementById('taskStartDate').value,
                        endDate: document.getElementById('taskEndDate').value,
                        assigneeId: document.getElementById('taskAssignee').value
                    };

                    if (!taskData.title.trim()) {
                        this.showMessage('Please enter a task title', 'error');
                        return;
                    }

                    if (form.dataset.editId) {
                        // Edit existing task
                        const taskIndex = this.data.tasks.findIndex(t => t.id === form.dataset.editId);
                        if (taskIndex !== -1) {
                            this.data.tasks[taskIndex] = { ...this.data.tasks[taskIndex], ...taskData };
                            this.saveData();
                            this.updateUI();
                            this.showMessage('Task updated successfully!', 'success');
                        }
                    } else {
                        // Add new task
                        this.addTask(taskData);
                    }

                    this.hideModal('addTaskModal');
                });

                // Team member form submission
                document.getElementById('submitTeamMember')?.addEventListener('click', () => {
                    const form = document.getElementById('addTeamMemberForm');
                    
                    const memberData = {
                        name: document.getElementById('memberName').value,
                        role: document.getElementById('memberRole').value,
                        email: document.getElementById('memberEmail').value,
                        department: document.getElementById('memberDepartment').value
                    };

                    if (!memberData.name.trim() || !memberData.role.trim()) {
                        this.showMessage('Please enter name and role', 'error');
                        return;
                    }

                    if (form.dataset.editId) {
                        // Edit existing member
                        const memberIndex = this.data.teamMembers.findIndex(m => m.id === form.dataset.editId);
                        if (memberIndex !== -1) {
                            this.data.teamMembers[memberIndex] = { ...this.data.teamMembers[memberIndex], ...memberData };
                            this.updateTaskAssigneeOptions();
                            this.saveData();
                            this.updateUI();
                            this.showMessage('Team member updated successfully!', 'success');
                        }
                    } else {
                        // Add new member
                        this.addTeamMember(memberData);
                    }

                    this.hideModal('addTeamMemberModal');
                });

                // Settings form
                document.getElementById('saveSettings')?.addEventListener('click', () => {
                    this.data.project.name = document.getElementById('projectName').value;
                    this.data.project.company = document.getElementById('projectCompany').value;
                    this.data.project.client = document.getElementById('projectClient').value;
                    this.data.project.duration = parseInt(document.getElementById('projectDurationSetting').value);
                    this.data.project.startDate = document.getElementById('projectStartDate').value;
                    this.data.project.endDate = this.calculateEndDate(this.data.project.duration);

                    this.saveData();
                    this.updateUI();
                    this.showMessage('Settings saved successfully!', 'success');
                });

                document.getElementById('resetSettings')?.addEventListener('click', () => {
                    if (confirm('Are you sure you want to reset settings to default?')) {
                        this.data.project = {
                            name: "Aramco Sadqam - Boilers Replacement",
                            company: "Harris Pye",
                            client: "Aramco Sadqam",
                            duration: 5,
                            startDate: new Date().toISOString().split('T')[0],
                            endDate: this.calculateEndDate(5)
                        };
                        this.updateSettings();
                        this.saveData();
                        this.showMessage('Settings reset to default!', 'success');
                    }
                });
            }

            // Filters and Search
            setupFilters() {
                // Task filters
                document.getElementById('statusFilter')?.addEventListener('change', () => {
                    this.updateTasksList();
                });

                document.getElementById('priorityFilter')?.addEventListener('change', () => {
                    this.updateTasksList();
                });

                document.getElementById('taskSearch')?.addEventListener('input', () => {
                    this.updateTasksList();
                });
            }

            // Export/Import Functions
            setupExportImport() {
                document.getElementById("exportDataBtn")?.addEventListener("click", () => {
                    this.exportData();
                });

                document.getElementById("triggerImport")?.addEventListener("click", () => {
                    document.getElementById("importFileInput").click();
                });

                document.getElementById("importFileInput")?.addEventListener("change", (event) => {
                    const file = event.target.files[0];
                    if (file) {
                        this.importData(file);
                    }
                });
            }

            exportData() {
                const dataStr = JSON.stringify(this.data, null, 2);
                const dataBlob = new Blob([dataStr], { type: "application/json" });
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement("a");
                link.href = url;
                link.download = `harris-pye-project-${new Date().toISOString().split("T")[0]}.json`;
                link.click();
                
                URL.revokeObjectURL(url);
                this.showMessage("Data exported successfully!", "success");
            }

            importData(file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        // Merge imported data with existing data, prioritizing imported data
                        this.data = { ...this.data, ...importedData };
                        this.saveData();
                        this.updateUI();
                        this.showMessage("Data imported successfully!", "success");
                    } catch (error) {
                        this.showMessage("Error importing data. Please check the file format.", "error");
                    }
                };
                reader.readAsText(file);
            }

            // Utility Functions
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            calculateEndDate(durationMonths) {
                const startDate = new Date();
                const endDate = new Date(startDate);
                endDate.setMonth(endDate.getMonth() + durationMonths);
                return endDate.toISOString().split('T')[0];
            }

            formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            }

            formatStatus(status) {
                const statusMap = {
                    'pending': 'Pending',
                    'in-progress': 'In Progress',
                    'completed': 'Completed',
                    'overdue': 'Overdue'
                };
                return statusMap[status] || status;
            }

            updateUI() {
                this.updatePageContent(this.currentPage);
            }

            showMessage(message, type = 'info') {
                // Remove existing messages
                document.querySelectorAll('.message').forEach(msg => msg.remove());

                const messageEl = document.createElement('div');
                messageEl.className = `message ${type}`;
                messageEl.textContent = message;
                document.body.appendChild(messageEl);

                // Show message
                setTimeout(() => messageEl.classList.add('show'), 100);

                // Hide message after 3 seconds
                setTimeout(() => {
                    messageEl.classList.remove('show');
                    setTimeout(() => messageEl.remove(), 300);
                }, 3000);
            }

            // Add sample data method
            addSampleData() {
                // Add sample team members
                this.data.teamMembers = [
                    {
                        id: "tm1",
                        name: "Ahmed Al-Rashid",
                        role: "Project Coordinator",
                        email: "ahmed.rashid@harrispye.com",
                        department: "project-management",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "tm2",
                        name: "Sarah Johnson",
                        role: "Senior Engineer",
                        email: "sarah.johnson@harrispye.com",
                        department: "engineering",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "tm3",
                        name: "Mohammed Al-Zahra",
                        role: "Construction Manager",
                        email: "mohammed.zahra@harrispye.com",
                        department: "construction",
                        createdAt: new Date().toISOString()
                    }
                ];

                // Add sample tasks
                this.data.tasks = [
                    {
                        id: "task1",
                        title: "Site Survey and Assessment",
                        description: "Conduct comprehensive site survey for boiler replacement project",
                        priority: "high",
                        status: "completed",
                        startDate: "2024-01-15",
                        endDate: "2024-01-30",
                        assigneeId: "tm2",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "task2",
                        title: "Equipment Procurement",
                        description: "Source and procure new boiler equipment according to specifications",
                        priority: "high",
                        status: "in-progress",
                        startDate: "2024-02-01",
                        endDate: "2024-03-15",
                        assigneeId: "tm1",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "task3",
                        title: "Safety Protocol Development",
                        description: "Develop comprehensive safety protocols for the replacement process",
                        priority: "medium",
                        status: "pending",
                        startDate: "2024-02-15",
                        endDate: "2024-03-01",
                        assigneeId: "tm3",
                        createdAt: new Date().toISOString()
                    }
                ];

                this.saveData();
                this.updateTaskAssigneeOptions();
            }
        }

        // Initialize the application
        let projectManager;

        document.addEventListener("DOMContentLoaded", () => {
            projectManager = new ProjectManager();
        });
    </script>
</body>
</html>

